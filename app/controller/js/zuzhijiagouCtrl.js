/*!qinglongWeb-1.0.0 2017-11-01*/
App.controller("zuzhijiagouCtrl",["$scope","$http","ngDialog","PagerExtends","layerAlert","serverUrls","PcService","$q",function(a,b,c,d,e,f,g,h){a.list=[],a.TitleText="新增",a.searchOption={name:""},a.create=!1,a.PcService=g,a.serverUrls=f,a.PreOrganization=[];var i=function(a,b,c){c.forEach(function(c,d){c.name===a&&(c.opts=b,c.originValue=b[0]?b[0].Id:"")})},j=[{Id:0,Name:"无上级"}],k=function(a,c){b({method:"get",url:f.organizationAll+"?state=0"}).success(function(b){var d=b.State.Code,f=b.State.Message;0===d?(0!==b.Content.length&&(a.PreOrganization=j.concat(b.Content)),i("ParentId",a.PreOrganization,a.fieldsList),c&&c.resolve("success")):e.autoclose(f)}).error(function(a){e.autoclose(g.errorResult(a))})};a.creatOne=function(){var b=h.defer(),d=b.promise;k(a,b),d.then(function(){var b=a.fieldsList,d=a.fetchData;g.initFormList(b),a.create=!0,c.openConfirm({template:"createOne",controller:["$scope",function(a){a.fetchData=d,a.fieldsList=b,a.TitleText="新增",a.formSubmit=function(){g.formSubmit(a,!0,a.fieldsList,f.addOrganization)}}],className:"ngdialog-theme-default",closeByDocument:!1,width:600})})};a.editItem=function(b){var d=h.defer(),e=d.promise;k(a,d),e.then(function(d){var e=a.fetchData,h=a.fieldsList;g.bindFormData(b,h),a.create=!1,c.openConfirm({template:"createOne",controller:["$scope",function(a){a.fieldsList=h,a.fetchData=e,a.TitleText="修改",a.formSubmit=function(){g.formSubmit(a,!1,a.fieldsList,f.upOrganization,b)}}],className:"ngdialog-theme-default",closeByDocument:!1,width:600})})},a.fetchData=function(){g.fetchData(a,f.organizationList,a.searchOption)},a.fetchData(),a.fieldsList=[{name:"Name",nameDisplay:"组织名称",editor:"normal",required:!0,value:"",originValue:""},{name:"ParentId",nameDisplay:"上级组织",editor:"select",required:!0,value:"",opts:a.PreOrganization,originValue:0},{name:"Telephone",nameDisplay:"联系电话",editor:"normal",required:!1,value:"",originValue:""},{editor:"textarea",name:"Describe",nameDisplay:"描述",required:!1,value:"",originValue:""},{name:"Sort",nameDisplay:"排序号",editor:"normal",required:!1,value:"",originValue:""}]}]);