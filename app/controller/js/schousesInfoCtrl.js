/*!qinglongWeb-1.0.0 2017-11-01*/
App.controller("schousesInfoCtrl",["$scope","$http","ngDialog","PagerExtends","layerAlert","serverUrls","PcService","$filter",function(a,b,c,d,e,f,g,h){a.list=[],a.navList=[{Id:1,Name:"按院落统计",Checked:!0},{Id:2,Name:"入住率统计",Checked:!1},{Id:3,Name:"户平均人数统计",Checked:!1}],a.selectedItem=a.navList[0];var i=document.getElementById("myEcharts"),j=echarts.init(i),k=function(b,c){var d=[],e=[],f=[];switch(b){case 1:f=["数量"],c.forEach(function(a,b){e[b]=a.Count,d[b]=a.Name});break;case 2:f=["入住率"],c.forEach(function(a,b){e[b]=a.OccupancyRate,d[b]=a.Name});break;case 3:f=["户平均数"],c.forEach(function(a,b){e[b]=a.OccupancyRate,d[b]=a.Name})}2===b&&e.forEach(function(a,b){a=Number(a)}),a.xAxisArray=d,a.seriesArray=e,a.seriesNames=f;var g={title:{text:"基础资源库统计",subtext:"重点人群、关注人群"},tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},grid:{left:"1%",right:"1%",bottom:"5%",containLabel:!0},legend:{data:[]},toolbox:{feature:{saveAsImage:{show:!0},magicType:{show:!0,type:["line","bar"]}}},calculable:!0,xAxis:[{type:"category",data:d,axisLabel:{interval:0}}],yAxis:[{type:"value"}],series:[]};g.series.push({name:f,type:"bar",data:e}),j.setOption(g,!0)};a.fetchData=function(){var c={type:a.selectedItem.Id},d=f.housestatistic,h="?";if(c){for(var i in c)h+=i+"="+c[i]+"&";d+=h.substring(0,h.length-1)}a.listBusyPromise=b({method:"get",url:d}).success(function(b){var c=b.State.Code;b.State.Message;0===c&&(a.list=b.Content,k(a.selectedItem.Id,a.list))}).error(function(a){e.autoclose(g.errorResult(a))})},a.fetchData(),a.setState=function(b){a.fetchData()},a.CheckItem=function(b){a.navList.forEach(function(a,c){a.Checked=!1,a.Id===b.Id&&(a.Checked=!0)}),a.selectedItem=b,a.fetchData()}}]);