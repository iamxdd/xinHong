/*!qinglongWeb-1.0.0 2017-11-01*/
App.controller("shixiangchuliCtrl",["$scope","$http","ngDialog","PagerExtends","layerAlert","serverUrls","PcService",function(a,b,c,d,e,f,g){a.list=[],a.searchOption={value:"",usageLevel:-1},a.navTabList=[{Id:1,Name:"管理员事项处理",Active:!0},{Id:2,Name:"居民事项处理",Active:!1}],a.WorkflowerStates=[{Id:0,Name:"等待"},{Id:1,Name:"执行"},{Id:2,Name:"中断"},{Id:3,Name:"成功"},{Id:4,Name:"废弃"}],a.selectTab=a.navTabList[0],a.checkedItem={},a.fieldsList=[{name:"Number",nameDisplay:"标题",editor:"normal",required:!0,value:""},{name:"Number",nameDisplay:"信息描述",editor:"textarea",required:!1,value:""}],a.checked=function(b){a.navTabList.forEach(function(a,c){a.Name===b.Name?a.Active=!0:a.Active=!1}),a.selectTab!==b&&(a.selectTab=b,a.fetchData(a.selectTab.Id))};a.fetchData=function(b){var c,d={};1===b?(c=f.ewSelectorlist,d=a.searchOption):(c=f.eventfeedbackList,d={isNeedBind:2,usageLevel:0},d=$.extend(!0,d,a.searchOption)),g.fetchData(a,c,d)},a.fetchData(a.selectTab.Id);var h=function(a,c){a.ngDialogPromise=b({method:"get",url:f.workflowNodersbystepid+"?stepid="+c.Id}).success(function(a){var b=a.State.Code;a.State.Message;0===b&&(c.Nodes=a.Content,c.Nodes.forEach(function(a,b){a.show=!1}))}).error(function(a){e.autoclose(a||a+"")})},i=[{name:"Name",nameDisplay:"姓名",editor:"normal",required:!0,value:"",disabled:!0},{name:"Sex",nameDisplay:"性别",editor:"normal",required:!0,value:"",disabled:!0},{name:"Phone",nameDisplay:"手机",editor:"normal",required:!0,value:"",disabled:!0},{name:"Nationality",nameDisplay:"名族",editor:"normal",required:!0,value:"",disabled:!0},{name:"CurrentAddress",nameDisplay:"现居住地",editor:"normal",required:!0,value:"",disabled:!0},{name:"DomicilePlace",nameDisplay:"户籍所在地",editor:"normal",required:!0,value:"",disabled:!0},{name:"SocialSecurity",nameDisplay:"社保状态",editor:"normal",required:!0,value:"",disabled:!0},{name:"ResidencePermit",nameDisplay:"居住证类型",editor:"normal",required:!0,value:"",disabled:!0},{name:"MaritalStatus",nameDisplay:"婚姻状态",editor:"normal",required:!0,value:"",disabled:!0}],j=function(a,d,f){a.ngDialogPromise=b({method:"get",url:d+"?id="+f.Worker.FormId}).success(function(a){var b=a.State.Code,d=a.State.Message;0===b?(f.Worker.FormList=a.Content,f.Worker.FormList&&c.openConfirm({template:"detailOne",controller:["$scope",function(a){a.fieldsList=i,g.bindFormData(f.Worker.FormList,a.fieldsList)}],className:"ngdialog-theme-default",closeByDocument:!1,width:600})):e.autoclose(d)}).error(function(a){e.autoclose(a||a+"")})},k=function(a,c){a.ngDialogPromise=b({method:"get",url:f.getworkerBynoderid+"?noderid="+c.Id}).success(function(b){var d=b.State.Code;b.State.Message;if(0===d)if(c.Worker=b.Content[0],2!==c.Worker.WorkNodeWorkerType)e.autoclose("该节点工作类型没有表单！");else{var g="";switch(c.Worker.FormType){case 0:g=f.getFloating;break;case 1:g=f.getFloating;break;case 2:g=f.getFloating;break;case 3:g=f.getKeypopulation}j(a,g,c)}}).error(function(a){e.autoclose(a||a+"")})};a.detailItem=function(a){c.openConfirm({template:"seeOne",controller:["$scope",function(c){c.PcService=g,c.WorkflowNoderStates=[{Id:0,Name:"等待中，未开始"},{Id:1,Name:"开始运行"},{Id:2,Name:"完成"},{Id:3,Name:"被中止,节点不会进入下一节点"}];var d=a.WorkflowerId?a.WorkflowerId:a.WorkflowId;c.ngDialogPromise=b({method:"get",url:f.workFlowerprogress+"?workflowerId="+d}).success(function(a){var b=a.State.Code,d=a.State.Message;0===b?c.Steps=a.Content:e.autoclose(d)}).error(function(a){e.autoclose(a||a+"")}),c.getItsNodes=function(a){a.show=!a.show,a.show&&(a.Nodes||h(c,a))},c.getItsWorks=function(a){k(c,a)}}],className:"ngdialog-theme-default",closeByDocument:!1,width:600})}}]);